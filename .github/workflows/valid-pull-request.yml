name: Validere pull request
on:
  pull_request:
    types: [opened, synchronize]
jobs:
  lint:
    name: Lint
    runs-on: ubuntu-latest
    steps:
      - uses: "./setup.yml@main"
      - name: Sjekke opp mot Lint-regler
        run: yarn run lint
  test:
    name: Tester
    runs-on: ubuntu-latest
    steps:
      - uses: "./setup.yml@main"
      - name: Kjøre tester
        run: yarn test --maxWorkers=2
  test-cypress:
    name: Cypress-tester
    runs-on: ubuntu-latest
    steps:
      - uses: "./setup.yml@main"
      - name: Kjør E2E-tester
        uses: cypress-io/github-action@v4
        with:
          start: yarn start:e2e
          wait-on: "http://localhost:8080"
          wait-on-timeout: 60
  build:
    name: Bygge kode
    needs: [lint, test, test-cypress]
    runs-on: ubuntu-latest
    steps:
      - name: Bygge kode
        run: yarn build
